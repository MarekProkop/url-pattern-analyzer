<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Analyzer Test</title>
</head>

<body>
    <h1>Analyzer Test</h1>
    <pre id="output"></pre>
    <script src="js/analyzer.js"></script>
    <script>
        function runTest(name, input, expectedPatterns) {
            const output = document.getElementById('output');
            output.textContent += `\n--- Test: ${name} ---\n`;

            try {
                const results = analyzer.analyze(input);
                const resultPatterns = results.map(r => r.pattern);

                // Sort both for comparison
                const sortedResult = [...resultPatterns].sort();
                const sortedExpected = [...expectedPatterns].sort();

                const passed = JSON.stringify(sortedResult) === JSON.stringify(sortedExpected);

                output.textContent += `Input: ${JSON.stringify(input, null, 2)}\n`;
                output.textContent += `Patterns: ${JSON.stringify(sortedResult)}\n`;
                output.textContent += `Result: ${passed ? 'PASS' : 'FAIL'}\n`;

                if (!passed) {
                    output.textContent += `Expected: ${JSON.stringify(sortedExpected)}\n`;
                }
            } catch (e) {
                output.textContent += `Error: ${e.message}\n`;
                console.error(e);
            }
        }

        const analyzer = new UrlAnalyzer();

        // Test 1: Basic Grouping
        runTest('Basic Grouping', [
            'https://example.com/products/123',
            'https://example.com/products/456',
            'https://example.com/products/789'
        ], [
            'https://example.com/products/…'
        ]);

        // Test 2: Multiple Patterns
        runTest('Multiple Patterns', [
            'https://example.com/products/123',
            'https://example.com/categories/abc'
        ], [
            'https://example.com/…/…'
        ]);

        // Test 3: Single URL
        runTest('Single URL', [
            'https://example.com/foo'
        ], [
            '…://….…/…'
        ]);

        // Test 4: Mixed
        runTest('Mixed', [
            'https://example.com/blog/a',
            'https://example.com/blog/b',
            'https://example.com/about'
        ], [
            'https://example.com/blog/…',
            'https://example.com/…'
        ]);

        // Test 5: User Reported Bug (Static segment after dynamic)
        runTest('Static after Dynamic', [
            'https://www.example.com/01/p/001',
            'https://www.example.com/02/p/002',
            'https://www.example.com/03/p/003',
            'https://www.example.com/04/p/004',
            'https://www.example.com/05/p/005'
        ], [
            'https://www.example.com/…/p/…'
        ]);
    </script>
</body>

</html>